<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Introduction to TreeSimGM</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to TreeSimGM</h1>



<p>Simulation of phylogenetic trees are becoming popular when raising new hypothesis and determining important deterministic forces governing macroevolutionary processes. However, most researches in the area build their own algorithms or use existing simulation tools that are built on different platforms and/or as standalone programs. This makes model selection, replicability, use of cluster computing and pipelining more laborious and prone to failure.</p>
<p><em>TreeSimGM</em> is an R package available at CRAN under the GPL-2 license for simulating stochastic phylogenetic trees making use of a general and flexible macroevolutionary model. More specifically, with <em>TreeSimGM</em> you can:</p>
<ul>
<li><p>specify any desired probability distribution for the <strong>waiting times until speciation and extinction </strong> (e.g. age-dependent speciation/extinction).</p></li>
<li><p>allow for <strong>lineage specific changes</strong> in the waiting time to speciation and/or extinction. Meaning that the waiting times to speciation / extinction may be scaled in different parts of the tree allowing for clade-dependent diversification processes on top of the chosen speciation and extinction processes.</p></li>
<li><p>define the <strong>speciation mode</strong>, i.e. if one descendant species inherits the age of the ancestor species (we call it the asymetric speciation mode), or if both descendant species are new species of age 0 (we call it the symmetric speciation mode).</p></li>
<li><p>use different <strong>stopping assumptions</strong>, i.e. if the simulated trees have a specific number of extant tips <code>sim.taxa()</code>, or if a user-specified stem age is simulated <code>sim.age()</code>.</p></li>
<li><p>have complete and incomplete <strong>sampling</strong> that can be uniform or proportional to pendant branch lengths.</p></li>
</ul>
<p>Such generality not only allows you to simulate stochastic phylogenetic trees assuming several popular existing models, such as the Yule model, the constant rate birth-death model, and proportional to distinguishable arrangement models, but also allows you to formulate and explore new macroevolutionary models.</p>
<p>This document introduces you to <em>TreeSimGM’s</em> and elucidates with examples how to simulate trees under different models and settings. If you would like to reproduce the exact same result, please use <code>set.seed(1987)</code>, since most of the trees presented here are generated under stochastic processes.</p>
<div id="stopping-assumptions" class="section level2">
<h2>Stopping Assumptions</h2>
<p>There are only two main functions in <em>TreeSimGM</em>: <code>sim.age()</code> and <code>sim.taxa()</code> which are used to simulate trees that contain a certain age or number of living tips respectively. To simulate trees with an age of 2 under a Yule model (exponentially distributed waiting time until speciation with rate 1.2) is simple. After having loaded <code>library(TreeSimGM)</code>, generate one single tree and plot it, using <code>sim.age()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree &lt;-<span class="st"> </span><span class="kw">sim.age</span>(<span class="dt">age=</span><span class="dv">3</span>,<span class="dt">numbsim=</span><span class="dv">1</span>,<span class="st">&quot;rexp(1.2)&quot;</span>)
<span class="kw">plot</span>(tree[[<span class="dv">1</span>]], <span class="dt">main=</span><span class="st">&quot;Simulated tree of age 3&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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lDFpDtKYNAcQKKQRKKQRKKQRKKQRKGJyL89HRKCIqYw9a45AEVFVxH5DKIFigeCFvMwbSP7gHfV4vYk5Se/HS+yLfBAoFgjPSWqzjX6ORKDZ22xOktul8skimGeV0Q/NSTJvvot/wWMCzd1Ko/8wJ6l7w3LB86CYZYXRD89JMuK/hZlAc7fC6IfnJDUrvI5EoPlbY/TDF/Ja5S3MBJq7FUefOUn4eeuNPnOSEMF6o8+cJESQ+OgTaO4SH30CVRP9dclX/0E/h0DVxB6txEefQNUQ6AiBqiHQEQJVk3Cg5v0ivB80d+kGat6+7N4/EhGBqkk3UPvKJ9dJyl0SgU5Mmmu40lz+Ugh0+kJedpZSTASqJoVApy7kVRfRP6eeQNVED3QFkxfyin8lBQJVk8RohS/k1TRcjjt/iYxW4EJe7tsEmrkERis4ac51Gn3eMYGqSWC0Ji7kZebFxz6J3yZQzLHBFvlZ4UlzZRH9s+2S+Pe6MwltkVwmzWGOdLZINpPmMEc6WySbSXOYgy0ywnCoYYuMMBxq2CIjDIcatsgIw6GGLTLCcKhJe4vUKV5EAXMkvUXSfKkTc6S8Rd6P0V/rTHk48pTEFgnPSaqKNN9RjzlS2CLhOUnV27fo1/FKYjj2JYUtMjUnaTT7I44UhmNfXv1uvx8xNSdphbePECgWmJiTNJr9EQeBYpHgnKTYHyvSECgWmLyQV/xzJALFfFMX8lrhOl4EigUmLuQV/1rHBApxBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBAppBApp/wO2WgVNA96NgwAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Similarly, a single tree simulated until reaching 5 living tips, under the same model as before, is generated by the function <code>sim.taxa()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree &lt;-<span class="st"> </span><span class="kw">sim.taxa</span>(<span class="dt">numbsim=</span><span class="dv">1</span>, <span class="dt">n=</span><span class="dv">5</span>, <span class="dt">waitsp=</span><span class="st">&quot;rexp(1.2)&quot;</span>)
<span class="kw">plot</span>(tree[[<span class="dv">1</span>]], <span class="dt">main=</span><span class="st">&quot;Simulated tree with 5 living tips&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>However, when simulating trees with <code>sim.taxa()</code> one needs to be aware of potential biases promoted by the stopping assumptions. It could be that, by chance, a specific number of living tips, let’s say <code>n=5</code>, coexisted more than once through the time of tree evolution. If you sample trees at every first time it achieves 5 living tips, you might be biasing the simulation towards young trees. It could be that a tree reaches 5 tips but grows and at another timepoint exhibits 5 tips again. In this case, all trees with 5 tips should have a positive probability of existing, and sampling only the first one would then generate the small trees bias. This problem could be solved by simulating trees that go until m coexisting tips ( with m&gt;&gt;n such that chances are very small that a tree on m tips shrinks again to a tree on n tips) and thereafter sample uniformly among all time points that this tree reached 5 tips. This can be done by setting <code>m=10</code> (m is the tip number in the final tree) and gsa=TRUE. Keep in mind that this only is necessary if there is an extinction process taking place.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree &lt;-<span class="st"> </span><span class="kw">sim.taxa</span>(<span class="dt">numbsim=</span><span class="dv">1</span>, <span class="dt">n=</span><span class="dv">5</span>, <span class="dt">m=</span><span class="dv">10</span>, <span class="dt">waitsp=</span><span class="st">&quot;rexp(1.2)&quot;</span>, <span class="dt">waitext=</span><span class="st">&quot;rexp(1.1)&quot;</span>, <span class="dt">gsa=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(tree[[<span class="dv">1</span>]], <span class="dt">main=</span><span class="st">&quot;Returned tree with 5 living tips from simulated tree with 10 tips&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When simulating with <code>sim.age</code> not always are trees returned. More specifically, if the tree is extinct before the defined age, the output is a ZERO. A ONE is returned if only one extant species exists. This can happen if speciation is too weak.</p>
<p>Simulating 100 trees under <code>sim.age()</code> with exponential speciation and extinction will not always return phylogenetic trees.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree &lt;-<span class="st"> </span><span class="kw">sim.age</span>(<span class="dt">age=</span><span class="dv">2</span>, <span class="dt">numbsim=</span><span class="dv">100</span>, <span class="dt">waitsp=</span><span class="st">&quot;rexp(1)&quot;</span>, <span class="dt">waitext=</span><span class="st">&quot;rexp(1)&quot;</span>)
<span class="kw">table</span>(<span class="kw">unlist</span>(<span class="kw">lapply</span>(tree, class)))
<span class="co">#&gt; </span>
<span class="co">#&gt; numeric   phylo </span>
<span class="co">#&gt;      66      34</span></code></pre></div>
<p>To access the last simulated tree.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree[[<span class="dv">100</span>]]
<span class="co">#&gt; [1] 0</span></code></pre></div>
<p>It happens to be a tree that went extinct before reaching the defined age.</p>
</div>
<div id="defining-speciation-and-extinction-distributions" class="section level2">
<h2>Defining Speciation and Extinction Distributions</h2>
<p>In order to simulate different macroevolutionary models, <code>TreeSimGM</code> allows you to define different distributions for the waiting times until speciation (parameter <code>waitsp</code>) and extinction (parameter <code>waitext</code>). This can be done in two ways, by using a string with the chosen waiting time distribution and parameters or by using a function that generates a single waiting time per call.</p>
<div id="setting-waiting-times-with-strings" class="section level4">
<h4>Setting waiting times with strings</h4>
<p>As shown in the previous examples, we can determine the waiting times by parsing to the respective parameter (either <code>waitsp</code> or <code>waitext</code>) the name of the random number generator function under the desired probability function and its parameters except for the first. As we need only one randomly generated waiting time per draw, this first parameter of the random number generator function (always the number of observations) is to be omitted from the input string. For example, let’s imagine we would like to use an exponential waiting time until speciation. To know its parameters, we can run <code>?rexp</code>.</p>
<p>You see that <code>rexp</code> takes basically two arguments <code>n</code> (number of observation) and <code>rate</code> (what we need to specify). Thus to simulate a tree with exponential waiting times with speciation rate of 0.9 the waitsp argument should be <code>waitsp=rexp(0.9)</code>. To simulate a tree with weibull waiting time until speciation and exponential waiting time until extinction, first let’s look at the random generation function for the weibull distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?rweibull</code></pre></div>
<p>From the R Documentation we know that <code>rweibull(n, shape, scale = 1)</code>, thus on <code>waitsp</code> we should only inform <code>rweibull(shape, scale)</code>. Let’s take <code>shape=0.4</code> and <code>scale=3</code> and the extinction process as <code>rexp(0.1)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1989</span>)
tree &lt;-<span class="st"> </span><span class="kw">sim.age</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="st">&quot;rweibull(0.4,3)&quot;</span>, <span class="st">&quot;rexp(0.1)&quot;</span>)
<span class="kw">plot</span>(tree[[<span class="dv">1</span>]])</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For this input method, any probability density function available in R can be used.</p>
</div>
<div id="setting-waiting-times-with-user-defined-function" class="section level4">
<h4>Setting waiting times with user defined function</h4>
<p>To gain flexibility, we can simulate trees using own functions instead of strings as waiting times input. Let’s for example simulate a tree under the same conditions as the previous example. Note that here, we need to add all parameters necessary for the distribution function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1989</span>) <span class="co"># setting the same seed as before...</span>
tree_funk &lt;-<span class="st"> </span><span class="kw">sim.age</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dt">waitsp=</span>function()<span class="kw">rweibull</span>(<span class="dv">1</span>,<span class="fl">0.4</span>,<span class="dv">3</span>), <span class="dt">waitext=</span>function()<span class="kw">rexp</span>(<span class="dv">1</span>,<span class="fl">0.1</span>))</code></pre></div>
<p>This should generate an identical tree, and indeed they are.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(tree, tree_funk)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(tree[[<span class="dv">1</span>]], <span class="dt">main=</span><span class="st">&quot;tree (strings)&quot;</span>)
<span class="kw">plot</span>(tree_funk[[<span class="dv">1</span>]], <span class="dt">main=</span><span class="st">&quot;tree_funk (function)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now let’s explore the generality and advantage of this model and produce a tree based on our own defined waiting time rules! In our waiting time function, we choose to have exponentially distributed waiting times until speciation that are limit to be at least 0.5! If they are smaller than 0.5, the waiting time will be 0.5. Remember that this function needs to generate one single number.</p>
<p>Here is our waiting time until speciation function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">waitspfunk &lt;-<span class="st"> </span>function() {
wt=<span class="kw">rexp</span>(<span class="dv">1</span>,<span class="fl">1.5</span>)
if(wt&lt;<span class="fl">0.5</span>){wt=<span class="fl">0.5</span>}
<span class="kw">return</span>(wt)
}</code></pre></div>
<p>Now we plug <code>waitspfunk</code> in our function (you can also define it directly).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">funk_tree &lt;-<span class="st"> </span><span class="kw">sim.age</span>(<span class="dt">age=</span><span class="dv">2</span>, <span class="dt">numbsim=</span><span class="dv">1</span>, <span class="dt">waitsp=</span>waitspfunk)
<span class="kw">plot</span>(funk_tree[[<span class="dv">1</span>]])</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><code>waitext</code> will work the same way. You can also use functions to define shiftstregths, but we will get into that later…</p>
</div>
</div>
<div id="the-speciation-modes" class="section level2">
<h2>The Speciation Modes</h2>
<p>On top of the chosen distribution for speciation and extinction, the speciation mode can be chosen. A speciation event is defined as when one species splits into two. Two different modes at these splits are possible: (i) <strong>symmetric</strong>, where for every speciation event new waiting times until speciation and extinction are drawn for both daughter lineages; and (ii) <strong>asymmetric</strong>, where a speciation event results in one species with new waiting times, and another that carries the extinction time and age of its ancestor. The symmetric mode can be seen as an vicariant or allopatric process where divided populations undergo equal evolutionary forces while the asymmetric mode could be seen as a peripatric speciation where a mother lineage continues to exist.</p>
<p>Symmetric trees are simulated by default <code>symmetric=TRUE</code>. To simulate asymmetric trees set <code>symmetric=FALSE</code>.</p>
<p>To stress these speciation modes, let’s use a special model, namely one where all species speciate after 2Myr and go extinct after 2.5Myr. For this we can use <code>sim.age(age=10)</code> and the way we input functions as we just learned.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">symmetric_tree &lt;-<span class="st"> </span><span class="kw">sim.age</span>(<span class="dt">age=</span><span class="dv">10</span>, <span class="dt">numbsim=</span><span class="dv">1</span>, <span class="dt">waitsp=</span>function()<span class="dv">2</span>, <span class="dt">waitext=</span>function()<span class="fl">2.5</span>, <span class="dt">symmetric=</span><span class="ot">TRUE</span>)
asymmetric_tree &lt;-<span class="st"> </span><span class="kw">sim.age</span>(<span class="dt">age=</span><span class="dv">10</span>, <span class="dt">numbsim=</span><span class="dv">1</span>, <span class="dt">waitsp=</span>function()<span class="dv">2</span>, <span class="dt">waitext=</span>function()<span class="fl">2.5</span>, <span class="dt">symmetric=</span><span class="ot">FALSE</span>)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(symmetric_tree[[<span class="dv">1</span>]], <span class="dt">main=</span><span class="st">&quot;Symmetric tree&quot;</span>)
<span class="kw">plot</span>(asymmetric_tree[[<span class="dv">1</span>]], <span class="dt">main=</span><span class="st">&quot;Asymmetric tree&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This makes clear how these two mechanisms work. While on the symmetric mode, after every speciation event (2Myr) two new species are generated giving thus no chance for a deterministic extinction (2.5Myr) to happen, on the asymmetric mode how the “mother” lineage goes extinct after 0.5Myr after the speciation event that generate a new lineage that survives one next timestep.</p>
</div>
<div id="lineage-specific-changes" class="section level2">
<h2>Lineage-Specific Changes</h2>
<p>Lineage-specific changes are changes in the waiting times (speciation or extinction) that are hereditary, i.e. passed on to descending new species. To specify a shift (i.e. change) on speciation or extinction the arguments <code>shiftsp</code> and <code>shiftext</code> are used respectively. Each is a list containing <code>prob</code> and <code>strength</code> (hereafter <code>shiftXX$prob</code> and <code>shiftXX$strength</code> for a generalization of the speciation or extinction process).</p>
<p>In a simulated tree, the probability of a shift happening when a new species is formed is determined by <code>shiftXX$prob</code>, which by default is ZERO (meaning no shift) and should range within interval[0,1]. In case a shift happened, the strength of this shift will be determined by <code>shiftXX$strength</code>, that works similarly to <code>waitsp</code>, i.e. as a string or a function. The value obtained from <code>shiftXX$strength</code>, will be then multiplied by the speciation and/or extinction time (depending if we are using <code>shiftsp</code> and/or <code>shiftext</code>). This scaling factor will perpetuate to all descending species from this lineage, until a new shift happens that overwrites the inherited shift.</p>
<p>Note that a shift strength &gt; 1 will increase the waiting time while a shift strength &lt; 1 will decrease the waiting time.</p>
<p>Let us simulate Yule trees (speciation rate of 1.2) with shifts happening with a probability of 10% and a scaling factor f chosen uniformly between [0.3, 0.5], meaning that shifted species will have a higher speciation rate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree &lt;-<span class="st"> </span><span class="kw">sim.age</span>(<span class="dt">age=</span><span class="dv">2</span>, <span class="dt">numbsim=</span><span class="dv">1</span>, <span class="dt">waitsp=</span><span class="st">&quot;rexp(1.5)&quot;</span>, <span class="dt">shiftsp=</span><span class="kw">list</span>(<span class="dt">prob=</span><span class="fl">0.1</span>, <span class="dt">strength=</span><span class="st">&quot;runif(0.3,0.5)&quot;</span>))
<span class="kw">plot</span>(tree[[<span class="dv">1</span>]], <span class="dt">main=</span><span class="st">&quot;Yule tree with speciation shifts&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>One can spot how ‘speciation shifted species’, i.e. labeled with “Ss” have a much shorter waiting times until speciation.</p>
<p>By default <code>tiplabel=c(&quot;sp.&quot;, &quot;ext.&quot;,&quot;Ss&quot;, &quot;Se&quot;)</code>. It is a vector of 4 strings/labels that will be given for each tip that [1] survived until the present; [2] got extinct [3] experienced speciation shifts or [4] experienced extinction shifts along the way to the root. An automatic sequential number is added to the chosen label.These labels can be changed using the argument <code>tiplabel</code>.</p>
<p>Let’s now simulate 5 trees under the constant birth-death models (i.e. exponentially distributed waiting times until speciation and extinction) but adding changes in the waiting time to speciation and extinction. This time, we will change these labels.</p>
<p>For this, we will alter a bit the stopping assumption and use <code>sim.taxa()</code> for a change.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree &lt;-<span class="st"> </span><span class="kw">sim.taxa</span>(<span class="dt">numbsim=</span><span class="dv">5</span>, <span class="dt">n=</span><span class="dv">6</span>, <span class="dt">waitsp=</span><span class="st">&quot;rexp(1)&quot;</span>, <span class="dt">waitext=</span><span class="st">&quot;rexp(0.5)&quot;</span>, 
                 <span class="dt">shiftsp=</span><span class="kw">list</span>(<span class="dt">prob=</span><span class="fl">0.1</span>, <span class="dt">strength=</span>function()<span class="fl">0.5</span>), 
                 <span class="dt">shiftext=</span><span class="kw">list</span>(<span class="dt">prob=</span><span class="fl">0.1</span>, <span class="dt">strength=</span>function()<span class="fl">0.1</span> ),
                 <span class="dt">tiplabel=</span><span class="kw">c</span>(<span class="st">&quot;living bird &quot;</span>, <span class="st">&quot;ext bird &quot;</span>,<span class="st">&quot;SPshift&quot;</span>, <span class="st">&quot;EXTshift&quot;</span>))
<span class="kw">plot</span>(tree[[<span class="dv">1</span>]], <span class="dt">main=</span><span class="st">&quot;crBD tree with speciation and extinction shifts&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that here, we used deterministic shifts, meaning that every time a speciation shift happens the waiting times until speciation were scaled by 0.5 and every time a extinction shift happens the waiting times until extinction were scaled by 0.1, which results in a very low value, thus probably all species that suffered extinction shift will go extinct sooner or later.</p>
</div>
<div id="tracking-shifts" class="section level2">
<h2>Tracking shifts</h2>
<p>From the example simulated tree above, let’s look into details regarding the shifts.</p>
<p>To know how many trees we simulated</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(tree)
<span class="co">#&gt; [1] 5</span></code></pre></div>
<p>Let us explore the first one (same as plotted above) regarding rate shifts. Instead of counting the labels containing “shifts”, we now use another method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t1 &lt;-<span class="st"> </span>tree[[<span class="dv">1</span>]]
t1$shifted.sp.living
<span class="co">#&gt;      LivingSpecies shift</span>
<span class="co">#&gt; [1,]             1     0</span>
<span class="co">#&gt; [2,]             2     0</span>
<span class="co">#&gt; [3,]             3     0</span>
<span class="co">#&gt; [4,]             4     1</span>
<span class="co">#&gt; [5,]             5     1</span>
<span class="co">#&gt; [6,]             6     1</span></code></pre></div>
<p>This lists all living species, and the ones containing a shift=1 are the living species with ancestors having underwent a shift on the speciation process. The living species that contain a shift on the speciation are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t1$shifted.sp.living[t1$shifted.sp.living[,<span class="dv">2</span>]==<span class="dv">1</span>,<span class="dv">1</span>]
<span class="co">#&gt; [1] 4 5 6</span></code></pre></div>
<p>Similarly, one can quantify the shifts on extinction on the living species with <code>$shifted.ext.living</code> or the shifts on the extinct species with <code>$shifted.sp.extinct</code> and <code>$shifted.ext.extinct</code>.</p>
<p>As an example, lets account for which and how many living species suffered shifts (no matter if on the speciation or extinction process)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#which?</span>
shifted_living &lt;-<span class="st"> </span><span class="kw">unique</span>(t1$shifted.sp.living[t1$shifted.sp.living[,<span class="dv">2</span>]==<span class="dv">1</span>,<span class="dv">1</span>], t1$shifted.ext.living[t1$shifted.ext.living[,<span class="dv">2</span>]==<span class="dv">1</span>,<span class="dv">1</span>])
<span class="kw">print</span>(shifted_living)
<span class="co">#&gt; [1] 4 5 6</span>
<span class="co">#howmany?</span>
<span class="kw">length</span>(shifted_living)
<span class="co">#&gt; [1] 3</span></code></pre></div>
<p>Now let’s look deeper into these shifts. The scaling factors applied to every node are stored at <code>$shiftsp</code> and <code>$shiftext</code> for speciation and extinction shifts respectively. If we have had not only one possible shift strength, these could look more interesting, but for the sake of simplicity, let’s stay with the case study we are looking at and look at its shifts on speciation</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t1$shiftsp
<span class="co">#&gt;       node strength</span>
<span class="co">#&gt;  [1,]    8      1.0</span>
<span class="co">#&gt;  [2,]    9      1.0</span>
<span class="co">#&gt;  [3,]    7      1.0</span>
<span class="co">#&gt;  [4,]   10      1.0</span>
<span class="co">#&gt;  [5,]   11      1.0</span>
<span class="co">#&gt;  [6,]   12      1.0</span>
<span class="co">#&gt;  [7,]    1      1.0</span>
<span class="co">#&gt;  [8,]    2      1.0</span>
<span class="co">#&gt;  [9,]    3      1.0</span>
<span class="co">#&gt; [10,]   13      0.5</span>
<span class="co">#&gt; [11,]    4      0.5</span>
<span class="co">#&gt; [12,]   14      0.5</span>
<span class="co">#&gt; [13,]    5      0.5</span>
<span class="co">#&gt; [14,]    6      0.5</span></code></pre></div>
<p>Since all branches have the same shift, it is difficult to know if all the 3 living species that present a speciation shift inherited it from an common ancestor or if they had a new shift occurring every time.</p>
<p>To look at this, we can use the function <code>track.shift()</code> where the first argument defines if we want to track a speciation “sp” or an extinction “ext” shift. Having defined that, we just need to inform the tree object and the node we would like to track.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">track.shift</span>(<span class="dt">shift=</span><span class="st">&quot;sp&quot;</span>, <span class="dt">tree=</span>t1, <span class="dt">node=</span><span class="dv">4</span>)
<span class="co">#&gt; [1] &quot;sp&quot;</span>
<span class="co">#&gt;   9  10  12   4 </span>
<span class="co">#&gt; 1.0 1.0 1.0 0.5</span>
<span class="kw">track.shift</span>(<span class="dt">shift=</span><span class="st">&quot;sp&quot;</span>, <span class="dt">tree=</span>t1, <span class="dt">node=</span><span class="dv">5</span>)
<span class="co">#&gt; [1] &quot;sp&quot;</span>
<span class="co">#&gt;   9  10  12  13   5 </span>
<span class="co">#&gt; 1.0 1.0 1.0 0.5 0.5</span>
<span class="kw">track.shift</span>(<span class="dt">shift=</span><span class="st">&quot;sp&quot;</span>, <span class="dt">tree=</span>t1, <span class="dt">node=</span><span class="dv">6</span>)
<span class="co">#&gt; [1] &quot;sp&quot;</span>
<span class="co">#&gt;   9  10  12  13   6 </span>
<span class="co">#&gt; 1.0 1.0 1.0 0.5 0.5</span></code></pre></div>
<p>The result shows us all shifts in speciation between the root and a specific node or tip in the simulated tree, named by its node numbers. Our quick analysis tells us that living bird 5 and 6 share a “shifted ancestor” while living bird 3 does not.</p>
</div>
<div id="incomplete-sampling" class="section level2">
<h2>Incomplete Sampling</h2>
<p>To generate trees that are incompletely sampled, use the argument <code>sampling</code>. <code>sampling</code> is a list containing the sampling fraction <code>sampling$frac</code> and a boolean <code>sampling$branchprop</code> defining if the sampling should be proportional to the pendant branch lengths. Default is <code>sampling$branchprop=FALSE</code>, in the case <code>sampling$branchprop=TRUE</code>, longer branches would be more likely to be sampled. If <code>sampling$frac</code> is smaller than 1, one sampled tree is returned, and the full tree is further returned inside the tree object as <code>$beforesampling</code>. For the sampled tree, shift information can only be visualized through the tip labels, a complete shift history can be retrieved at the full tree $beforesampling. sampling=list(frac=1, branchprop=FALSE) is default.</p>
<p>Let’s assume we would like to get 100 trees with 5 living tips, while assuming that we can sample only 50% for all extant tips. To do this, we will use an asymmetric age-dependent (weibull distribution) speciation process for the speciation without any extinction process and use a speciation shift probability of 30% with strength that ranges uniformly between 0.5 and 0.9 (meaning that we have a shortening of waiting times until speciation for shifted species).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree &lt;-<span class="st"> </span><span class="kw">sim.taxa</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dt">waitsp=</span><span class="st">&quot;rweibull(0.5,2)&quot;</span>, <span class="dt">symmetric=</span><span class="ot">FALSE</span>, <span class="dt">shiftsp=</span><span class="kw">list</span>(<span class="dt">prob=</span><span class="fl">0.3</span>, <span class="dt">strength=</span><span class="st">&quot;runif(0.5,0.9)&quot;</span>), <span class="dt">sampling=</span><span class="kw">list</span>(<span class="dt">frac=</span><span class="fl">0.5</span>, <span class="dt">branchprop=</span><span class="ot">FALSE</span>))</code></pre></div>
<p>From these 100 simulated trees, lets plot two of them, with the complete tree next to the sampled tree</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>))
<span class="kw">plot</span>(tree[[<span class="dv">3</span>]]$beforesampling, <span class="dt">main=</span><span class="st">&quot;complete tree 3&quot;</span>)
<span class="kw">plot</span>(tree[[<span class="dv">3</span>]], <span class="dt">main=</span><span class="st">&quot;sampled tree 3&quot;</span>)
<span class="kw">plot</span>(tree[[<span class="dv">60</span>]]$beforesampling, <span class="dt">main=</span><span class="st">&quot;complete tree 60&quot;</span>)
<span class="kw">plot</span>(tree[[<span class="dv">60</span>]], <span class="dt">main=</span><span class="st">&quot;sampled tree 60&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
